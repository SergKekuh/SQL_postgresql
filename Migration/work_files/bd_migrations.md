

---

# üìò –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `bd_migrations` –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ pgAdmin

## 1. üß± –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `bd_migrations`

### ‚úÖ –®–∞–≥ 1: –í—Ö–æ–¥ –≤ PostgreSQL –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º `postgres`
```bash
sudo -u postgres psql
```

### ‚úÖ –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
CREATE DATABASE bd_migrations OWNER = postgres;
```

### ‚úÖ –®–∞–≥ 3: –í—ã—Ö–æ–¥ –∏–∑ `psql`
```sql
\q
```

---

## 2. üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `psql`:
```bash
sudo -u postgres psql -d bd_migrations
```

–¢–µ–ø–µ—Ä—å –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –≤–Ω—É—Ç—Ä–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `bd_migrations`.

---

## 3. üóÇÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

–í—Å—Ç–∞–≤—å —Å–ª–µ–¥—É—é—â–∏–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –ø–æ –ø–æ—Ä—è–¥–∫—É:

### ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `client_units`

```sql
CREATE TABLE client_units (
  unit_id SERIAL PRIMARY KEY,
  okpo_code VARCHAR(10) NOT NULL UNIQUE,
  okpo_s1c8 VARCHAR(10),
  ipn VARCHAR(10),
  unit_name VARCHAR(255),
  full_unit_name VARCHAR(255),
  legal_entity_type VARCHAR(10),
  note TEXT,

  CONSTRAINT valid_legal_entity CHECK (legal_entity_type IN ('–Æ—Ä.', '–§—ñ–∑.'))
);
```

---

### ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `years`

```sql
CREATE TABLE years (
  year_id SERIAL PRIMARY KEY,
  year INTEGER NOT NULL UNIQUE,
  note TEXT
);
```

---

### ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `groups`

```sql
CREATE TABLE groups (
  group_id SERIAL PRIMARY KEY,
  group_name VARCHAR(50) NOT NULL UNIQUE,
  note TEXT
);
```

---

### ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `client_activity`

```sql
CREATE TABLE client_activity (
  client_activity_id SERIAL PRIMARY KEY,
  unit_id INTEGER NOT NULL REFERENCES client_units(unit_id),
  year_id INTEGER NOT NULL REFERENCES years(year_id),
  group_id INTEGER NOT NULL REFERENCES groups(group_id),
  expense_invoices DECIMAL(15, 2),
  sales DECIMAL(15, 2),
  note TEXT,

  UNIQUE (unit_id, year_id)
);
```

---

## 4. üìê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü

### ‚úÖ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü:
```sql
\dt
```

### ‚úÖ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã:
```sql
\d client_units
```

---

## 5. üñ•Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ pgAdmin

pgAdmin ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PostgreSQL.

### ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pgAdmin (–¥–ª—è Ubuntu/Debian):

```bash
sudo apt install pgadmin4
```

–ò–ª–∏ —Å–∫–∞—á–∞–π —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞:  
üëâ [https://www.pgadmin.org/download/](https://www.pgadmin.org/download/)

### ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
–ü—Ä–∞–≤–∏–º —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
sudo nano /etc/postgresql/xx/main/pg_hba.conf
```

–î–æ–±–∞–≤–ª—è–µ–º:
```
local   all             postgres                                peer
local   all             all                                     peer
host    all             all             127.0.0.1/32            md5
host    all             all             ::1/128                 md5
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º PostgreSQL:
```bash
sudo systemctl restart postgresql
```

### ‚úÖ –ó–∞–ø—É—Å–∫ pgAdmin:
–ó–∞–π–¥–∏ –ø–æ –∞–¥—Ä–µ—Å—É:
```
http://localhost:5050
```

–°–æ–∑–¥–∞–π —É—á—ë—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

---

## 6. üé® –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π (ER Diagram)

### ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ ER Diagram –≤ pgAdmin

1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏:
   ```
   Servers > PostgreSQL > Databases > bd_migrations > Schemas > public
   ```
2. –ù–∞–∂–º–∏ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ ‚Üí `Diagrams` ‚Üí `ER Diagram`

### ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π —Ç–∞–±–ª–∏—Ü—ã
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–π
- –°–æ—Ö—Ä–∞–Ω—è–π –¥–∏–∞–≥—Ä–∞–º–º—É
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –∫–∞–∫ PNG –∏–ª–∏ SQL

---

## 7. üìù –ü—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –¥–∞–Ω–Ω—ã–º–∏

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ `client_units`

```sql
INSERT INTO client_units (okpo_code, okpo_s1c8, ipn, unit_name, full_unit_name, legal_entity_type, note)
VALUES 
('12345678', '87654321', '1234567890', '–¢–û–í –ê–ª—å—Ñ–∞', '–¢–æ–≤–∞—Ä–∏—Å—Ç–≤–æ –∑ –æ–±–º–µ–∂–µ–Ω–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—é "–ê–ª—å—Ñ–∞"', '–Æ—Ä.', '–û—Å–Ω–æ–≤–Ω–∏–π –∫–ª—ñ—î–Ω—Ç'),
('87654321', '12345678', '0987654321', '–§–û–ü –Ü–≤–∞–Ω–æ–≤', '–§—ñ–∑–∏—á–Ω–∞ –æ—Å–æ–±–∞-–ø—ñ–¥–ø—Ä–∏—î–º–µ—Ü—å –Ü–≤–∞–Ω–æ–≤ –Ü.–Ü.', '–§—ñ–∑.', '–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä');
```

---

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ `years`

```sql
INSERT INTO years (year, note)
VALUES 
(2023, '–†—ñ–∫ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–æ—Å—Ç—É'),
(2024, '–†—ñ–∫ –µ–∫—Å–ø–∞–Ω—Å—ñ—ó');
```

---

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ `groups`

```sql
INSERT INTO groups (group_name, note)
VALUES 
('–ì—Ä—É–ø–∞ –ê', '–ù–∞–π–±—ñ–ª—å—à–∞ –≥—Ä—É–ø–∞'),
('–ì—Ä—É–ø–∞ –ë', '–°–µ—Ä–µ–¥–Ω—è –≥—Ä—É–ø–∞');
```

---

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ `client_activity`

```sql
INSERT INTO client_activity (unit_id, year_id, group_id, expense_invoices, sales, note)
VALUES 
(1, 1, 1, 50000.00, 120000.00, '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å'),
(2, 2, 2, 30000.00, 90000.00, '–ú–∞–ª–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å');
```

---

## 8. üìã –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ `psql`
-----------------------------------------------------------------------
| –ö–æ–º–∞–Ω–¥–∞                    | –û–ø–∏—Å–∞–Ω–∏–µ                               |
|----------------------------|----------------------------------------|
| `\dt`                      | –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü                          |
| `\d –∏–º—è_—Ç–∞–±–ª–∏—Ü—ã`           | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã                      |
| `\d+ –∏–º—è_—Ç–∞–±–ª–∏—Ü—ã`          | –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞                    |
| `\l`                       | –°–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö                      |
| `\c –∏–º—è_–±–∞–∑—ã`              | –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –ë–î             |
| `\q`                       | –í—ã–π—Ç–∏ –∏–∑ psql                          |
-----------------------------------------------------------------------
